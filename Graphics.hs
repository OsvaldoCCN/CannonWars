module Graphics where

--CONSTANTES

-- Función que actualiza la matriz con los barcos
actualizaMatriz :: [[Char]] -> (Int, Int) -> Int -> Char -> [[Char]]
actualizaMatriz bigMatrix (x, y) a h = 
    zipWith replaceRow [0..] bigMatrix
  where
    -- Limitamos `a` para que esté entre 0 y 3
    limitedA = max 0 (min 3 a)

    -- Seleccionamos el tipo de barco según la orientación `h` y el ángulo `limitedA`
    smallMatrix = tipoBarco h limitedA --(Graphics.hs)

    smallRows = length smallMatrix
    smallCols = length (head smallMatrix)

    -- Ajustar la coordenada para centrar smallMatrix en (x, y)
    adjustedY = y - (smallRows `div` 2)
    adjustedX = x - (smallCols `div` 2)

    replaceRow i bigRow
      | i >= adjustedY && i < adjustedY + smallRows = 
          let smallRow = smallMatrix !! (i - adjustedY)
          in replaceCols bigRow smallRow adjustedX
      | otherwise = bigRow
    
    replaceCols bigRow smallRow startCol =
        take startCol bigRow ++ smallRow ++ drop (startCol + smallCols) bigRow

-- Formatos barcos
tipoBarco :: Char -> Int -> [[Char]]
tipoBarco h limitedA = case (h, limitedA) of
        -- Orientación derecha, ángulos 0, 30, 45, 75
        ('r', 0) -> 
          [ "                       "
          , "    █ █ █      ▄▄▄▄▄▄▄▄"
          , "┌┬┬████████  ▄██▀▀▀▀▀▀ "
          , "▀████████████████▀     "
          ]
        ('r', 1) -> 
          [ "                    ▄▄ "
          , "    █ █ █     ▄▄▄███▀▀ "
          , "┌┬┬████████  ███▀▀     "
          , "▀████████████████▀     "
          ]
        ('r', 2) -> 
          [ "                 ▄██▀ "
          , "    █ █ █      ▄██▀   "
          , "┌┬┬████████  ▄██▀     "
          , "▀████████████████▀    "
          ]
        ('r', 3) -> 
          [ "                ██    "
          , "    █ █ █      ██     "
          , "┌┬┬████████  ▄██▄     "
          , "▀████████████████▀    "
          ]
        -- Orientación izquierda, ángulos 0, 30, 45, 75
        ('l', 0) -> 
          [ "                       "
          , "▄▄▄▄▄▄▄▄      █ █ █    "
          , " ▀▀▀▀▀▀██▄  ████████┬┬┬"
          , "     ▀████████████████▀"
          ]
        ('l', 1) -> 
          [ " ▄▄                    "
          , " ▀▀███▄▄▄     █ █ █    "
          , "     ▀▀██   ████████┬┬┬"
          , "     ▀████████████████▀"
          ]
        ('l', 2) -> 
          [ "  ▀██▄                 "
          , "    ▀██▄      █ █ █    "
          , "      ▀██▄  ████████┬┬┬"
          , "     ▀████████████████▀"
          ]
        ('l', 3) -> 
          [ "     ██                "
          , "      ██      █ █ █    "
          , "      ▄██▄  ████████┬┬┬"
          , "     ▀████████████████▀"
          ]
        _ -> []  -- Manejar otros casos



--Matriz inicial
initialMatrix :: [[Char]]
initialMatrix =  
          [ "|                                                                                                                                                                       |"
          , "|                                                                                                                                                                       |"
          , "|                                                                                                                                                                       |"
          , "|                                                                                                                                                                       |"
          , "|                                                                                                                                                                       |"
          , "|                                                                                                                                                                       |"
          , "|                                                                                                                                                                       |"
          , "|                                                                                                                                                                       |"
          , "|                                                                                                                                                                       |"
          , "|                                                                                                                                                                       |"
          , "|                                                                                                                                                                       |"
          , "|                                                                                                                                                                       |"
          , "|                                                                                                                                                                       |"
          , "|                                                                                                                                                                       |"
          , "|                                                                                                                                                                       |"
          , "|                                                                                                                                                                       |"
          , "|                                                                                                                                                                       |"
          , "|                                                                                                                                                                       |"
          , "|                                                                                                                                                                       |"
          , "|                                                                                                                                                                       |"
          , "|                                                                                                                                                                       |"
          , "|                                                                                                                                                                       |"
          , "|                                                                                                                                                                       |"
          , "|                                                                                                                                                                       |"
          , "|                                                                                                                                                                       |"
          , "|                                                                                                                                                                       |"
          , "|                                                                                                                                                                       |"
          , "|                                                                                                                                                                       |"
          , "|                                                                                                                                                                       |"
          , "|                                                                                                                                                                       |"
          , "|                                                                                                                                                                       |"
          , "|                                                                                                                                                                       |"
          , "|                                                                                     ▒▒▒▒▒                                                                             |"
          , "|                                                                                   ▒▒▒▒▒▒▒▒▒▒▒                                                                         |"
          , "|                                                                                 ▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒                                                                       |"
          , "|                                                                               ▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒                                                                      |"
          , "|                                                                               ▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒                                                                    |"
          , "|                                                                              ▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒                                                                   |"
          , "|                                                                              ▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒                                                                  |"
          , "|                                                                           ▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒                                                                 |"
          , "|                                                                           ▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒                                                                 |"
          , "|                                                                          ▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒                                                                 |"
          , "|                                                                          ▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒                                                                 |"
          , "|                                                                        ▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒                                                               |"
          , "|                                                                      ▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒                                                               |"
          , "░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░"
          , "░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░"
          , "░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░"
          ]


--
--                 
--     █ █ █      ▄▄▄▄▄▄▄▄
-- ┌┬┬████████  ▄██▀▀▀▀▀▀ 
-- ▀████████████████▀     

--                  
--                     ▄▄
--     █ █ █     ▄▄▄███▀▀
-- ┌┬┬████████  ███▀▀
-- ▀████████████████▀    
         
--                   
--                  ▄██▀
--     █ █ █      ▄██▀
-- ┌┬┬████████  ▄██▀
-- ▀████████████████▀

--                  ██
--                 ██
--     █ █ █      ██
-- ┌┬┬████████  ▄██▄
-- ▀████████████████▀

--               ██
--               ██
--     █ █ █     ██
-- ┌┬┬████████  ▄██▄
-- ▀████████████████▀

--            ██
--             ██
--     █ █ █    ██
-- ┌┬┬████████  ▄██▄
-- ▀████████████████▀
